<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia Site Renderer 1.9.2 from src\site\markdown/expression_launguage.md at 2020-07-30
 | Rendered using Apache Maven Fluido Skin 1.9
-->
<html xmlns="http://www.w3.org/1999/xhtml" lang="ja">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="generator" content="Apache Maven Doxia Site Renderer 1.9.2" />
    <title>messageformatter &#x2013; EL式を使ったフォーマット</title>
    <link rel="stylesheet" href="./css/apache-maven-fluido-1.9.min.css" />
    <link rel="stylesheet" href="./css/site.css" />
    <link rel="stylesheet" href="./css/print.css" media="print" />
    <script src="./js/apache-maven-fluido-1.9.min.js"></script>
  </head>
  <body class="topBarDisabled">
    <div class="container-fluid">
      <header>
        <div id="banner">
          <div class="pull-left"><div id="bannerLeft"><h2>messageformatter</h2>
</div>
</div>
          <div class="pull-right"></div>
          <div class="clear"><hr/></div>
        </div>

        <div id="breadcrumbs">
          <ul class="breadcrumb">
      <li class=""><a href="index.html" title="Top">Top</a><span class="divider">/</span></li>
    <li class="active ">EL式を使ったフォーマット</li>
        <li id="publishDate" class="pull-right"><span class="divider">|</span> 最終更新: 2020-07-30</li>
          <li id="projectVersion" class="pull-right">バージョン: 0.1</li>
          </ul>
        </div>
      </header>
      <div class="row-fluid">
        <header id="leftColumn" class="span2">
          <nav class="well sidebar-nav">
  <ul class="nav nav-list">
   <li class="nav-header">使い方について</li>
    <li><a href="howtouse.html" title="基本的な使い方"><span class="none"></span>基本的な使い方</a></li>
    <li class="active"><a href="#"><span class="none"></span>EL式によるフォーマット</a></li>
    <li><a href="recursion.html" title="再帰的にメッセージを評価する"><span class="none"></span>再帰的にメッセージを評価する</a></li>
    <li><a href="beanvalidation.html" title="BeanValidationとの連携"><span class="none"></span>BeanValidationとの連携</a></li>
   <li class="nav-header">関連リンク</li>
    <li><a href="https://github.com/mygreen/messageformatter/" class="externalLink" title="GitHub"><span class="none"></span>GitHub</a></li>
    <li><a href="apidocs/index.html" title="JavaDoc"><span class="none"></span>JavaDoc</a></li>
   <li class="nav-header">プロジェクト文書</li>
    <li><a href="project-info.html" title="プロジェクト情報"><span class="icon-chevron-right"></span>プロジェクト情報</a></li>
    <li><a href="project-reports.html" title="プロジェクトレポート"><span class="icon-chevron-right"></span>プロジェクトレポート</a></li>
  </ul>
          </nav>
          <div class="well sidebar-nav">
            <hr />
            <div id="poweredBy">
              <div class="clear"></div>
              <div class="clear"></div>
              <div class="clear"></div>
<a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy"><img class="builtBy" alt="Built by Maven" src="./images/logos/maven-feather.png" /></a>
            </div>
          </div>
        </header>
        <main id="bodyColumn"  class="span10" >
<h1>EL&#x5f0f;&#x3092;&#x4f7f;&#x3063;&#x305f;&#x30d5;&#x30a9;&#x30fc;&#x30de;&#x30c3;&#x30c8;</h1>
<p>EL&#x5f0f;&#xff08;Epression Laungage&#xff09;&#x3068;&#x306f;&#x3001;&#x30aa;&#x30d6;&#x30b8;&#x30a7;&#x30af;&#x30c8;&#x306e;&#x30a2;&#x30af;&#x30bb;&#x30b9;&#x3092;&#x7c21;&#x7565;&#x5316;&#x3057;&#x3066;&#x8a18;&#x8ff0;&#x3067;&#x304d;&#x308b;&#x5f0f;&#x8a00;&#x8a9e;&#x3067;&#x3059;&#x3002;</p>
<p>&#x5b9f;&#x88c5;&#x306f;&#x8907;&#x6570;&#x5b58;&#x5728;&#x3057;&#x3001;&#x672c;&#x30e9;&#x30a4;&#x30d6;&#x30e9;&#x30ea;&#x3067;&#x306f;&#x4ee5;&#x4e0b;&#x306e;&#x7a2e;&#x985e;&#x3092;&#x30b5;&#x30dd;&#x30fc;&#x30c8;&#x3057;&#x307e;&#x3059;&#x3002;</p>
<ul>

<li><a class="externalLink" href="https://spring.pleiades.io/spring-integration/reference/html/spel.html">SpEL</a> : Spring Framework&#x6a19;&#x6e96;&#x306e;&#x5f0f;&#x8a00;&#x8a9e;&#x3002;</li>
<li><a class="externalLink" href="https://commons.apache.org/proper/commons-jexl/">JEXL</a> : JSP&#x306e;&#x5f0f;&#x8a00;&#x8a9e;&#x3092;&#x62e1;&#x5f35;&#x3057;&#x305f;Apache Commons &#x30d7;&#x30ed;&#x30b8;&#x30a7;&#x30af;&#x30c8;&#x306e;&#x4e2d;&#x306e;&#x30e9;&#x30a4;&#x30d6;&#x30e9;&#x30ea;&#x3002;</li>
</ul>
<p>JEXL&#x306e;&#x65b9;&#x304c;JSP&#x306e;EL&#x5f0f;&#x3068;&#x4ed5;&#x69d8;&#x304c;&#x5171;&#x901a;&#x3057;&#x3066;&#x304a;&#x308a;&#x308f;&#x304b;&#x308a;&#x3084;&#x3059;&#x3044;&#x3067;&#x3059;&#x304c;&#x3001;SpEL&#x306f;Spring Framework&#x6a19;&#x6e96;&#x306e;&#x8a00;&#x8a9e;&#x3067;&#x3042;&#x308b;&#x305f;&#x3081;Spring&#x74b0;&#x5883;&#x4e0b;&#x3067;&#x958b;&#x767a;&#x3059;&#x308b;&#x306e;&#x3067;&#x3042;&#x308c;&#x3070;&#x30e9;&#x30a4;&#x30d6;&#x30e9;&#x30ea;&#x306e;&#x8ffd;&#x52a0;&#x306a;&#x3069;&#x304c;&#x4e0d;&#x8981;&#x3067;&#x3059;&#x3002;</p><section>
<h2><a name="EL.E5.BC.8F.E3.81.AE.E5.87.A6.E7.90.86.E3.82.92JEXL.E3.81.AB.E5.88.87.E3.82.8A.E6.9B.BF.E3.81.88.E3.82.8B"></a>EL&#x5f0f;&#x306e;&#x51e6;&#x7406;&#x3092;JEXL&#x306b;&#x5207;&#x308a;&#x66ff;&#x3048;&#x308b;</h2>
<p>pom.xml&#x306b;JEXL&#x306e;&#x4f9d;&#x5b58;&#x95a2;&#x4fc2;&#x3092;&#x8ffd;&#x52a0;&#x3057;&#x307e;&#x3059;&#x3002; &#x672c;&#x30e9;&#x30a4;&#x30d6;&#x30e9;&#x30ea;&#x3067;&#x306f;&#x3001;JEXL v2.1&#x3092;&#x79c1;&#x7528;&#x3057;&#x307e;&#x3059;&#x3002;v3.x&#x306b;&#x306f;&#x5bfe;&#x5fdc;&#x3057;&#x3066;&#x3044;&#x307e;&#x305b;&#x3093;&#x3002;</p>

<div class="source">
<div class="source"><pre class="prettyprint">&lt;dependency&gt;
    &lt;groupId&gt;org.apache.commons&lt;/groupId&gt;
    &lt;artifactId&gt;commons-jexl&lt;/artifactId&gt;
    &lt;version&gt;2.1.1&lt;/version&gt;
    &lt;scope&gt;provided&lt;/scope&gt;
&lt;/dependency&gt;
</pre></div></div>

<p>&#x5f0f;&#x8a00;&#x8a9e;&#x306e;&#x51e6;&#x7406;&#x306e;&#x5b9f;&#x88c5;&#x3068;&#x3057;&#x3066;&#x3001; <code>JexlExpressionEvaluator</code> &#x3092;&#x6307;&#x5b9a;&#x3057;&#x307e;&#x3059;&#x3002;</p>

<div class="source">
<div class="source"><pre class="prettyprint">// JexlExpressionEvaluator &#x3092;&#x6307;&#x5b9a;&#x3057;&#x307e;&#x3059;&#x3002;
MessageInterpolator messageInterpolator = new MessageInterpolator(new JexlExpressionEvaluator());

MessageFormatter messageFormatter = new MessageFormatter(messageSource, messageInterpolator);
</pre></div></div>
</section><section>
<h2><a name="EL.E5.BC.8F.E3.81.A7.E3.81.AE.E5.87.A6.E7.90.86.E6.96.B9.E6.B3.95"></a>EL&#x5f0f;&#x3067;&#x306e;&#x51e6;&#x7406;&#x65b9;&#x6cd5;</h2>
<p>&#x30e1;&#x30c3;&#x30bb;&#x30fc;&#x30b8;&#x4e2d;&#x3067;&#x306f; <code>${EL&#x5f0f;}</code> &#x306b;&#x3066;&#x5b9a;&#x7fa9;&#x3057;&#x307e;&#x3059;&#x3002;</p>
<ul>

<li>&#x6a19;&#x6e96;&#x3067;&#x3001;<code>java.util.Formatter</code> &#x304c; &#x5909;&#x6570; <code>formatter</code> &#x3068;&#x3057;&#x3066;&#x4e88;&#x3081;&#x767b;&#x9332;&#x3055;&#x308c;&#x3066;&#x304a;&#x308a;&#x3001;<code>String#format(...)</code> &#x306e;&#x66f8;&#x5f0f;&#x3067;&#x30d5;&#x30a9;&#x30fc;&#x30de;&#x30c3;&#x30c8;&#x3067;&#x304d;&#x307e;&#x3059;&#x3002;</li>
<li>SpEL&#x3067;&#x306f;&#x5f0f;&#x4e2d;&#x306e;&#x5909;&#x6570;&#x3092; <code>#&#x5909;&#x6570;&#x540d;</code> &#x3067;&#x53c2;&#x7167;&#x3057;&#x307e;&#x3059;&#x3002;</li>
<li>JEXL&#x306f;&#x5f0f;&#x4e2d;&#x306e;&#x5909;&#x6570;&#x306f;&#x3001;<code>&#x5909;&#x6570;&#x540d;</code> &#x3067;&#x53c2;&#x7167;&#x3057;&#x307e;&#x3059;&#x3002;</li>
</ul>

<div class="source">
<div class="source"><pre class="prettyprint">## SpEL&#x306e;&#x5834;&#x5408;
message.el=&#x5024;&#xff08;${#formatter.format('%1.2f', #validatedValue)}) &#x306f;&#x3001;{min} &#x4ee5;&#x4e0a;&#x3067;&#x8a2d;&#x5b9a;&#x3057;&#x3066;&#x304f;&#x3060;&#x3055;&#x3044;&#x3002;

## JEXL&#x306e;&#x5834;&#x5408;
message.el=&#x5024;&#xff08;${formatter.format('%1.2f', validatedValue)}) &#x306f;&#x3001;{min} &#x4ee5;&#x4e0a;&#x3067;&#x8a2d;&#x3057;&#x3066;&#x304f;&#x3060;&#x3055;&#x3044;&#x3002;
</pre></div></div>

<p><code>param(...)</code> &#x3067;&#x6307;&#x5b9a;&#x3057;&#x305f;&#x30d1;&#x30e9;&#x30e1;&#x30fc;&#x30bf;&#x306f;&#x3001;EL&#x5f0f;&#x4e2d;&#x306e;&#x5909;&#x6570;&#x3068;&#x3057;&#x3066;&#x53c2;&#x7167;&#x3067;&#x304d;&#x307e;&#x3059;&#x3002;</p>

<div class="source">
<div class="source"><pre class="prettyprint">double validatedValue = 3.1;
String message = messageFormatter.create(&quot;message.el&quot;)
    .param(&quot;validatedValue&quot;, validatedValue)
    .param(&quot;min&quot;, 5)
    .format();
</pre></div></div>
</section><section>
<h2><a name="a.E6.A8.99.E6.BA.96.E3.81.AE.E3.82.AB.E3.82.B9.E3.82.BF.E3.83.A0.E9.96.A2.E6.95.B0.E3.82.92.E4.BD.BF.E7.94.A8.E3.81.99.E3.82.8B"></a>&#x6a19;&#x6e96;&#x306e;&#x30ab;&#x30b9;&#x30bf;&#x30e0;&#x95a2;&#x6570;&#x3092;&#x4f7f;&#x7528;&#x3059;&#x308b;</h2>
<p>EL&#x5f0f;&#x306e;&#x6a19;&#x6e96;&#x6587;&#x6cd5;&#x3060;&#x3051;&#x3067;&#x306f;&#x51e6;&#x7406;&#x304c;&#x8907;&#x96d1;&#x306b;&#x306a;&#x308b;&#x5834;&#x5408;&#x304c;&#x3042;&#x308b;&#x305f;&#x3081;&#x3001;&#x30af;&#x30e9;&#x30b9; <code>CustomFunctions</code> &#x5185;&#x306e;&#x30e6;&#x30fc;&#x30c6;&#x30a3;&#x30ea;&#x30c6;&#x30a3;&#x30e1;&#x30bd;&#x30c3;&#x30c9;&#x3092;&#x30ab;&#x30b9;&#x30bf;&#x30e0;&#x95a2;&#x6570;&#x3068;&#x3057;&#x3066;&#x767b;&#x9332;&#x3057;&#x3066;&#x304a;&#x308a;&#x3001;&#x5229;&#x7528;&#x3067;&#x304d;&#x307e;&#x3059;&#x3002;</p>
<table border="0" class="table table-striped">
<thead>

<tr class="a">
<th> &#x30ab;&#x30b9;&#x30bf;&#x30e0;&#x95a2;&#x6570; </th>
<th> &#x8aac;&#x660e;  </th></tr>
</thead><tbody>

<tr class="b">
<td> <code>empty(&#x5024;)</code>  </td>
<td> &#x5f15;&#x6570;&#x3067;&#x6e21;&#x3057;&#x305f;&#x5024;&#x304c; <code>null</code> &#x307e;&#x305f;&#x306f;&#x7a7a;&#x304b;&#x3069;&#x3046;&#x304b;&#x5224;&#x5b9a;&#x3057;&#x307e;&#x3059;&#x3002;&#x6587;&#x5b57;&#x5217;&#x306e;&#x5834;&#x5408;&#x306f;&#x7a7a;&#x6587;&#x5b57;&#x304b;&#x3069;&#x3046;&#x304b;&#x3001;&#x914d;&#x5217;&#x3084;Collection&#x3001;Map&#x306e;&#x5834;&#x5408;&#x306f;&#x8981;&#x7d20;&#x6570;&#x304c;0&#x304b;&#x3089;&#x3069;&#x3046;&#x304b;&#x3082;&#x5224;&#x5b9a;&#x3057;&#x307e;&#x3059;&#x3002;</td></tr>
<tr class="a">
<td> <code>defaultString(&#x5024;)</code>  </td>
<td> &#x5f15;&#x6570;&#x3067;&#x6e21;&#x3057;&#x305f;&#x5024;&#x304c; <code>null</code> &#x306e;&#x3068;&#x304d;&#x3001;&#x7a7a;&#x6587;&#x5b57;&#x306b;&#x5909;&#x63db;&#x3057;&#x307e;&#x3059;&#x3002;<code>null</code> &#x51fa;&#x306a;&#x3044;&#x3068;&#x304d;&#x306f;&#x3001;&#x5024;&#x306f;&#x305d;&#x306e;&#x307e;&#x307e;&#x3002;</td></tr>
<tr class="b">
<td> <code>join(&#x5024;, &#x533a;&#x5207;&#x308a;&#x6587;&#x5b57;)</code>  </td>
<td> &#x5f15;&#x6570;&#x3067;&#x6e21;&#x3057;&#x305f;&#x5024;&#xff08;&#x914d;&#x5217;&#x3001;Collection&#xff09;&#x3092;&#x533a;&#x5207;&#x308a;&#x6587;&#x5b57;&#x3067;&#x7d50;&#x5408;&#x3057;&#x307e;&#x3059;&#x3002;</td></tr>
<tr class="a">
<td> <code>size(&#x5024;)</code>  </td>
<td> &#x5f15;&#x6570;&#x3067;&#x6e21;&#x3057;&#x305f;&#x5024;&#xff08;&#x914d;&#x5217;&#x3001;Collection&#x3001;&#x6587;&#x5b57;&#x5217;&#xff09;&#x306e;&#x30b5;&#x30a4;&#x30ba;&#x3092;&#x8fd4;&#x3057;&#x307e;&#x3059;&#x3002;</td></tr>
</tbody>
</table>
<ul>

<li>SpEL&#x306e;&#x5834;&#x5408;&#x306f;&#x3001;<code>#&#x30ab;&#x30b9;&#x30bf;&#x30e0;&#x95a2;&#x6570;&#x540d;(&#x5f15;&#x6570;)</code> &#x306e;&#x66f8;&#x5f0f;&#x3067;&#x547c;&#x3073;&#x51fa;&#x3057;&#x307e;&#x3059;&#x3002;</li>
<li>JEXL&#x306e;&#x5834;&#x5408;&#x306f;&#x3001;<code>f:&#x30ab;&#x30b9;&#x30bf;&#x30e0;&#x95a2;&#x6570;&#x540d;(&#x5f15;&#x6570;)</code> &#x306e;&#x66f8;&#x5f0f;&#x3067;&#x547c;&#x3073;&#x51fa;&#x3057;&#x307e;&#x3059;&#x3002;</li>
</ul>

<div class="source">
<div class="source"><pre class="prettyprint">## SpEL&#x306e;&#x5834;&#x5408;
message.spel=&#x5024;&#x306f; ${#join(#array, ',')} &#x306e;&#x4f55;&#x308c;&#x304b;&#x3067;&#x8a2d;&#x5b9a;&#x3057;&#x3066;&#x304f;&#x3060;&#x3055;&#x3044;&#x3002;

## JXEL&#x306e;&#x5834;&#x5408;
message.jexl=&#x5024;&#x306f; ${f:join(array, ',')} &#x306e;&#x4f55;&#x308c;&#x304b;&#x3067;&#x8a2d;&#x5b9a;&#x3057;&#x3066;&#x304f;&#x3060;&#x3055;&#x3044;&#x3002;
</pre></div></div>

<div class="source">
<div class="source"><pre class="prettyprint">String validatedValue = &quot;-&quot;;
String message = messageFormatter.create(&quot;message.el&quot;)
    .param(&quot;validatedValue&quot;, validatedValue)
    .param(&quot;array&quot;, new String[]{&quot;&#x3007;&quot;, &quot;&#xd7;&quot;, &quot;&#x25b3;&quot;})
    .format();
</pre></div></div>
</section><section>
<h2><a name="a.E7.8B.AC.E8.87.AA.E3.81.AE.E3.82.AB.E3.82.B9.E3.82.BF.E3.83.A0.E9.96.A2.E6.95.B0.E3.82.92.E7.99.BB.E9.8C.B2.E3.81.99.E3.82.8B"></a>&#x72ec;&#x81ea;&#x306e;&#x30ab;&#x30b9;&#x30bf;&#x30e0;&#x95a2;&#x6570;&#x3092;&#x767b;&#x9332;&#x3059;&#x308b;</h2>
<p>SpEL&#x306e;&#x5834;&#x5408;&#x3001;<code>StaticMethodMapCreator</code> &#x306b;&#x3066;&#x3001;&#x30e6;&#x30fc;&#x30c6;&#x30a3;&#x30ea;&#x30c6;&#x30a3;&#x30af;&#x30e9;&#x30b9;&#x304b;&#x3089;&#x3001; <code>public static</code> &#x30e1;&#x30bd;&#x30c3;&#x30c9;&#x3092;&#x62bd;&#x51fa;&#x3057;&#x3001;&#x30ab;&#x30b9;&#x30bf;&#x30e0;&#x95a2;&#x6570;&#x3068;&#x3057;&#x3066;&#x767b;&#x9332;&#x3057;&#x307e;&#x3059;&#x3002;</p>

<div class="source">
<div class="source"><pre class="prettyprint">// &#x30e6;&#x30fc;&#x30c6;&#x30a3;&#x30ea;&#x30c6;&#x30a3;&#x30e1;&#x30bd;&#x30c3;&#x30c9;&#x306e;&#x30de;&#x30c3;&#x30d7;&#x3092;&#x4f5c;&#x6210;&#x3057;&#x307e;&#x3059;
Map&lt;String, Method&gt; functionMap = StaticMethodMapCreator.create(SampleUtils.class);

// &#x30ab;&#x30b9;&#x30bf;&#x30e0;&#x95a2;&#x6570;&#x3092;&#x767b;&#x9332;&#x3057;&#x307e;&#x3059;&#x3002;
SpelExpressionEvaluator expressionEvaluator = new SpelExpressionEvaluator();
expressionEvaluator.getCustomFunctions.putAll(functionMap);

// MessageFormatter&#x306e;&#x7d44;&#x307f;&#x7acb;&#x3066;
MessageFormatter messageFormatter = new MessageFormatter(messageSource, new MessageInterpolator(expressionEvaluator));
</pre></div></div>

<p>JEXL&#x306e;&#x5834;&#x5408;&#x3001;<code>JexlEngine#getFunction()</code> &#x304b;&#x3089;&#x30ab;&#x30b9;&#x30bf;&#x30e0;&#x95a2;&#x6570;&#x306e;&#x30de;&#x30c3;&#x30d7;&#x3092;&#x7a2e;&#x75d8;&#x3057;&#x3066;&#x3001;&#x63a5;&#x982d;&#x8a9e;&#x3092;&#x6307;&#x5b9a;&#x3057;&#x3066;&#x3001;&#x30e6;&#x30fc;&#x30c6;&#x30a3;&#x30ea;&#x30c6;&#x30a3;&#x30af;&#x30e9;&#x30b9;&#x3092;&#x767b;&#x9332;&#x3057;&#x307e;&#x3059;&#x3002;</p>

<div class="source">
<div class="source"><pre class="prettyprint">// &#x30ab;&#x30b9;&#x30bf;&#x30e0;&#x95a2;&#x6570;&#x3092;&#x767b;&#x9332;&#x3057;&#x307e;&#x3059;&#x3002;&#x3002;
JexlExpressionEvaluator expressionEvaluator = new JexlExpressionEvaluator();
expressionEvaluator.getJexlEngine().getFunctions.put(&quot;c&quot;, SampleUtils.class);

// MessageFormatter&#x306e;&#x7d44;&#x307f;&#x7acb;&#x3066;
MessageFormatter messageFormatter = new MessageFormatter(messageSource, new MessageInterpolator(expressionEvaluator));
</pre></div></div></section>
        </main>
      </div>
    </div>
    <hr/>
    <footer>
      <div class="container-fluid">
        <div class="row-fluid">
            <p>&#169;      2020
<a href="http://mygreen.github.io/messageformatter/">mygreen</a>
</p>
        </div>
      </div>
    </footer>
  </body>
</html>
